## 取り組んだ課題一覧
- DjangoでECサイトを作る（チェックアウト機能の実装・PR提出）

## わかったこと
- 在庫管理は「表示（UX）」と「購入確定時の検証（正しさ）」で役割を分ける必要がある
- 購入確定時は `select_for_update()` を使い、DBの行ロック下で最新在庫を必ず再チェックすることが重要
- ロック後の `Product` を `CartItem.product` に差し替えることで、画面表示・合計金額・バッジ表示のズレを防げる
- 在庫切れ商品はカート計算（合計金額・個数）から除外し、削除を促すUIにするのが自然
- フロント側で操作を防ぎつつ最終的な在庫チェックや数量調整はバックエンドで担保する設計が安全
- カート削除処理を fetch 化するとUXが大きく改善し、失敗時はリロードにフォールバックするのが堅い
- フォームエラー時の再描画でも在庫調整を行わないと数量が意図せず1に戻るなどの表示バグが起きる
- `select_for_update()` のロック対象は Python オブジェクトではなくDB上の行そのものである

## 感じたこと、メモ
- 途中でペースが落ちた時期もあり一ヶ月もかかってしまったが、チェックアウト機能のPR提出まで持っていけて大きな達成感があった。  
https://github.com/ngimixin/django_ec/pull/4
- 在庫管理や同時購入対策は想像以上に考慮点が多くECの難所だと実感した。
- 表示・UXとバックエンドの責務を切り分けて考えられるようになってきたのは成長ポイントだと思う。

## 次やること
- DjangoでECサイトを作る（プロモーションコード機能実装）

## 学習時間
- 今日：3h00m
- 今週：7h45m（土-）
- 今月：32h00m
- 累計：875h30m