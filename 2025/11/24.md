## 取り組んだ課題一覧
- DjangoでECサイトを作る（商品一覧・商品詳細ページのPR提出、商品管理機能の実装）
## わかったこと
- ForeignKey は「親1 : 子多」の関係を DB レベルで表現する仕組みで、子モデルに `ForeignKey(Parent, ...)` を定義すると ID カラム（例：`order_id`）が作られ、Python 側では `child.parent` で親オブジェクトにアクセスできる。
- `MEDIA_ROOT` / `MEDIA_URL` と `STATICFILES_DIRS` / `STATIC_URL` を組み合わせることで、「どのフォルダのファイルを、どのURLから配信するか」を Django に教えている。開発中は `static()` / `MEDIA_URL` の設定で Django 自身が配信役、本番では Nginx などが担当するイメージ。
- モデルに `unique=True` を後から付けるときは、①まず unique なしでカラムを追加 → ②既存レコードを一意に整える → ③`unique=True` に変更して再マイグレーション、という“制約を段階的に強くする”やり方が安全。
- `related_name` は「親インスタンスから子たちをどう呼ぶか」を決める名前で、`related_name="items"` としておくと `order.items.all()` のように自然なコードになる。何も指定しないと `order.orderitem_set.all()` のような少し読みにくい名前になる。
- `git add` は「ファイルを追加するコマンド」ではなく「作業ツリーの状態（追加・変更・削除）をステージに写すコマンド」で、削除したファイルを `git add 削除したパス` すると「削除としてステージされる」。移動は `git mv` が安全で、コミットしたくない変更は `git restore`（必要なら `--staged`）で元に戻せる。
- コンテキストプロセッサーは「全テンプレートに毎回共通で渡したい変数（SITE_TITLE, COPYRIGHT_YEAR など）を自動で注入する仕組み」で、settings に定義 → `context_processors.py` で返す → TEMPLATES に登録、という流れでどのテンプレでも `{{ SITE_TITLE }}` が使えるようになり、ブランド名のハードコーディングを減らせる。
- Basic認証デコレータは、`request.META['HTTP_AUTHORIZATION']` からヘッダを取り出し、Base64 デコードして `username:password` を取り出し、正しければ本来のビューを実行、間違っていれば 401 と `WWW-Authenticate` を返してブラウザに認証ダイアログを出させる“門番”として働く。
- `WWW-Authenticate` ヘッダの realm に日本語を入れると、HTTP ヘッダが ASCII 前提なため Django が MIME エンコードしてしまい、`Basic realm="..."` の形が崩れて Chrome が Basic 認証ダイアログを出してくれない。realm は英数字のみで付けるのが安全、という学びを得た。
- `HttpResponse` は「本文（第1引数）」「ステータスコード（status 引数）」「レスポンスヘッダ（辞書風に追加）」で構成されており、401 を返しつつ `response["WWW-Authenticate"] = 'Basic realm="ProductManagement"'` のようにヘッダを足すことで、ブラウザ側の挙動（認証ダイアログ表示）まで制御できる。
- `curl` は「ブラウザなしで HTTP リクエストを送るためのコマンド」で、`curl -i` でレスポンスヘッダを含めて確認したり、`-u admin:pw` で Basic認証付きアクセスを試したりできる。認証ヘッダやステータスコードのデバッグにはほぼ必須のツール。
- Bootstrap は「よく使う CSS を人間が覚えやすい class 名として提供する巨大辞書」のようなもので、`d-flex`（display:flex）、`justify-content-end` などを組み合わせてレイアウトを組める。CSS を1から書かなくても、class を付けるだけでそれなりの見た目やレイアウトが手に入る。
- Django の ModelForm は内部に常に `instance` を1つ持っていて、`instance=product` を渡せば UPDATE、渡さなければ pk=None の新規インスタンスとして INSERT になる。`request.POST` は生データの QueryDict、`cleaned_data` は型変換・バリデーション済みの値で、`form.save()` は cleaned_data を instance に上書きして `.save()` を呼ぶ流れ。
- `<form>` に `action` を書かない場合、HTML の仕様として「現在のURL」に送信される。Django の create/edit 画面はこの仕様を利用して、同じ URL で GET（フォーム表示）と POST（送信処理）を切り替えつつ、バリデーションエラー時も同じ画面に戻れるようになっている。
- 画像アップロード付きフォームでは、HTML 側で `enctype="multipart/form-data"` を付け、Django 側では `ProductForm(request.POST, request.FILES)` のように `request.FILES` を渡さないとファイルが送信されない。フォーム構造とサーバ側の処理はセットで覚える必要がある。
- Django フォームと Bootstrap を組み合わせるときは、「label（`for=id_for_label`）」「`{{ form.field }}`」「エラー表示」の3点セットで書くのが基本で、`id_for_label` を使うことで Django が自動生成した input の id と label の for を正しく紐づけられる。見た目は widgets で統一し、テンプレート側は構造に集中するのがきれい。
- `docker compose logs -f web` のようにログを流しっぱなしにしておくと、ブラウザでの操作と Django 側のログ（print、エラー、スタックトレース）をリアルタイムに対応づけて見られる。これは `tail -f` や `journalctl -f` と同じで、開発〜本番運用まで一貫して使われる“ログの見方の基本”になっている。
- `{% load static tz %}` は Django が内部に持っているテンプレートタグライブラリ（staticタグ、タイムゾーンフィルタ）を読み込む宣言で、config ディレクトリとは関係ない。`{% extends %}` の直後に `{% load %}` を書くのが正しく、`{% load static tz %}` とスペース区切りでまとめてロードできる。
## 感じたこと、メモ
- やっぱりアウトプットしながらだとすごく学びが多いしやってて面白い。
- 今日は ForeignKey や related_name、フォーム instance、fixtures、Basic認証デコレータ、ログの見方など「Django で実務的な開発をするうえで避けて通れないポイント」がかなり線でつながった感覚があった。特に realm の文字コード問題を curl とレスポンスヘッダから切り分けていった流れは、トラブルシューティングとして良い経験になった。
- Git や dumpdata/loaddata、`docker compose logs -f web` なども、「コマンドを知っている」から一歩進んで「裏で何が起きていて、なぜこの手順だと安全なのか」までイメージできるようになってきていて、ちゃんと自分の血肉になってきている実感がある。
## 次やること
- DjangoでECサイトを作る（商品管理画面：一覧・作成・編集・削除の仕上げとPR提出）
## 学習時間
- 今日：9h00m
- 今週：16h15m（土-）
- 今月：84h15m
- 累計：760h30m