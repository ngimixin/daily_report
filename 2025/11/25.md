## 取り組んだ課題一覧
- DjangoでECサイトを作る（商品管理機能のPR提出・カート機能実装とセッション周りの整理）
## わかったこと
- Djangoのセッションは「ブラウザ側のセッションID（Cookie）」と「サーバ側のセッションデータ（django_session）」が分離した仕組みで、`request.session` はそのデータを辞書のように扱える `SessionStore` 。
- セッションIDは「セッションに何か保存した瞬間」に発行され、Cookie にセットされ、DB の `session_key` と対応して動いている。
- SessionMiddleware が、`request.session` の初期化・DB読込・レスポンス時の保存・Cookie設定まで全部面倒を見ているため、ビュー側は辞書感覚で操作するだけでOK。
- ビューは HTTP の入口として最小限にして、ビジネスロジックはサービス層に切り出すのが定石で、`get_or_create_cart()` を `services/cart.py` に分離したのはその最初のステップになった。
- `get_or_create()` のタプルアンパック `(obj, created)` の意味と、`defaults={...}` が「新規作成時にだけ適用される初期値」であることを理解できた。
- `with transaction.atomic()` によるトランザクション管理は、成功時自動コミット・例外時自動ロールバックとなり、複数のDB操作を一括で整合させるために重要。
- `@require_POST` でビューを POST 限定にすることで、URL直叩きGETによる副作用実行を防げる。
- `request.POST` の正体は QueryDict であり、値は内部的にリスト保持だが `.get()` で単一値を取得できる仕組みになっている。
- `.filter().first()` は例外が出ず `None` で返るため、「存在しない可能性が普通にあるデータ」（Cartなど）を安全に扱える。
- `select_related("product")` を使うと JOIN した状態で1クエリで取得でき、カート画面での N+1 問題を避けられる。
- 商品詳細・一覧ページの「カートに入れる」ボタンをフォーム＋CSRF＋POSTに変更し、安全な追加処理に近づいた。
- 商品詳細では在庫数から `quantity` の選択肢レンジを生成し、UI的にも自然な実装ができた。
## 感じたこと、メモ
- 商品一覧・商品詳細ページのPR承認いただけた。
- 「セッション」「サービス層」「トランザクション」「QueryDict」みたいに、今後 Django を使ううえで役立つ基礎がよく学べた。
## 次やること
- DjangoでECサイトを作る（カート機能実装）
## 学習時間
- 今日：3h30m
- 今週：19h45m（土-）
- 今月：87h45m
- 累計：764h00m